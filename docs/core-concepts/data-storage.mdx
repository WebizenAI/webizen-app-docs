import { Mermaid } from 'nextra/components'

# Data Storage in Webizen

Webizen employs a sophisticated, multi-layered data storage architecture designed to balance performance, data sovereignty, and decentralized resilience. Instead of relying on a single database, the platform intelligently uses different storage systems for different types of data.

The three primary storage layers are: **Quadstore**, **Solid Pods**, and **IPFS**.

### Storage Architecture Diagram

This diagram illustrates how data flows between the different storage layers and the application's background process.

<Mermaid chart={`
graph TD
    subgraph "Webizen Desktop Application"
        A[Background Process]
    end

    subgraph "Local High-Performance Cache"
        B[Quadstore (IndexedDB)]
    end

    subgraph "User-Owned Authoritative Storage"
        C[Solid Pod (Local or Remote)]
    end

    subgraph "Decentralized File Storage"
        D[IPFS Network]
    end

    A -- "Fast Queries & Caching" <--> B
    A -- "Persist & Sync" <--> C
    A -- "Store/Retrieve Files" <--> D
    C -- "Contains Pointers (CIDs) to" --> D

    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#f8c8dc,stroke:#333,stroke-width:2px
    style C fill:#a7c7e7,stroke:#333,stroke-width:2px
    style D fill:#c1e1c1,stroke:#333,stroke-width:2px
`} />

### 1. Quadstore: The High-Speed Local Cache

- **Technology**: A high-performance, browser-compatible RDF database that runs locally within the Webizen Desktop Application, typically using IndexedDB as its backend.
- **Purpose**: To act as a "hot" data cache. It stores structured RDF data that the application needs to access quickly for UI rendering, faceted searches, and real-time operations. All immediate data interactions within the application are performed against the Quadstore to ensure a responsive user experience.
- **Data Type**: Stores structured, relational metadata, such as user settings, address book contacts, project task lists, and pointers (IPFS CIDs) to larger files.
- **Lifecycle**: Data in the Quadstore is considered ephemeral or a cache. It is periodically synchronized with the user's authoritative Solid Pod.

### 2. Solid Pod: The Source of Truth

- **Technology**: A W3C-standardized personal online datastore (Pod). In Webizen, a Solid Pod server runs locally as part of the Desktop Application, but it can also sync with a user's remote Pod provider.
- **Purpose**: The Solid Pod is the user's **authoritative data store**. It is the source of truth for their identity and all personal data. It holds the master copy of the user's "identity fabric."
- **Data Type**: Stores all of the user's core RDF data, including their WebID profile, social connections, agreements, and the metadata that links to files stored on IPFS.
- **Lifecycle**: Data is persisted to the Solid Pod for long-term storage and sovereignty. The Pod's access control mechanisms (WAC) are used to manage permissions, ensuring that only authorized applications and users can read or write data.

### 3. IPFS: Immutable File Storage

- **Technology**: The InterPlanetary File System, a peer-to-peer network for storing and sharing files in a distributed, content-addressed manner.
- **Purpose**: To store large, binary files and data objects that are not suitable for a graph database. This includes documents, images, videos, audio files, and the **Hypermedia Content Packages**.
- **Data Type**: Any binary data. Files are chunked, content-addressed to get a unique Content Identifier (CID), and stored on the P2P network.
- **Lifecycle**: Data on IPFS is immutable. Once a file is added, it cannot be changed without its CID also changing. The CID of the file is then stored as a piece of metadata in the user's Solid Pod, linking the structured RDF data to the unstructured file content. For example, a user's profile might contain a triple: `<#me> <foaf:img> <ipfs://Qm...>.`

By combining these three layers, Webizen achieves the best of all worlds: the speed of a local cache, the sovereignty of a personal data server, and the resilience of a decentralized file network.
