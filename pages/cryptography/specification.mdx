# Cryptography Specification and Policy

**Version:** 2.1
**Date:** 2025-07-13

## 1. Introduction & Strategic Objectives

This document provides a definitive specification for the cryptographic standards, policies, and implementations within the Webizen v0.26 ecosystem. The primary objective is to establish a robust, multi-layered, and future-proof security posture by integrating post-quantum cryptography with established, high-performance algorithms.

The strategic goals of this cryptographic framework are:

-   **Post-Quantum Readiness:** To protect high-value and long-term data from the threat of quantum computing by employing **SPHINCS+** and evaluating next-generation PQC algorithms like **Falcon**.
-   **Ecosystem Compatibility:** To ensure seamless interoperability with existing blockchain and identity systems by utilizing **ECDSA** over the **secp256k1** curve.
-   **Performance & Scalability:** To optimize for speed and efficiency in handling transient data by leveraging **EdDSA**, and to accelerate complex operations using **WebAssembly (WASM)**.
-   **Confidentiality and Data Integrity:** To provide strong data-at-rest protection through **AES** and to ensure data in transit is secure and compact using standards like **COSE**.
-   **Verifiable Trust and Compliance:** To build a framework that can adhere to recognized standards such as **FIPS** and leverage privacy-enhancing technologies like **Zero-Knowledge Proofs (ZKPs)**.
-   **Policy-Driven Governance:** To manage the application of these cryptographic primitives through a clear, configurable, and centralized signing policy.

## 2. Core Cryptographic Primitives

Webizen v0.26 mandates the use of specific cryptographic libraries and configurations to ensure uniformity and security across all modules.

| Primitive  | Type                           | Library & Configuration                        | Use Case Category                | Rationale & Strategic Value                                                                                                                                              |
| :--------- | :----------------------------- | :--------------------------------------------- | :------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SPHINCS+** | Post-Quantum Digital Signature | `sphincs 3.0.4` (using SHAKE256-robust)        | **High-Value & Long-Term Data** | A state-of-the-art, stateless hash-based signature scheme providing resilience against attacks from both classical and quantum computers.                                   |
| **ECDSA** | Elliptic Curve Digital Signature | `@cashtab/wallet-lib` on `secp256k1`           | **Blockchain & Financial Data** | The de-facto standard for most cryptocurrencies, including eCash. Its use is mandated for any operations involving blockchain-related data to ensure native compatibility. |
| **EdDSA** | Modern Digital Signature       | `ed25519 1.7.3`                                | **Transient & High-Volume Data** | A high-performance, misuse-resistant signature scheme ideal for scenarios requiring fast signing and verification, such as chat messages.                                 |
| **AES** | Symmetric Key Encryption       | `CryptoJS 4.1.1`                               | **Data-at-Rest Confidentiality** | A globally recognized and vetted algorithm for securing data confidentiality, employed in pre-shared key scenarios, such as encrypting backups.                           |
| **Falcon** | Post-Quantum Digital Signature | *For future evaluation* | **Next-Gen Compact Signatures** | A lattice-based PQC signature scheme selected by NIST, known for its highly compact signature sizes. Slated for evaluation for use cases where storage efficiency is paramount. |

## 3. Cryptographic Policy & Module Integration

The application of the above primitives is governed by a strict, centralized policy implemented in `modules/security/index.js` and configured in `config/webizen-config-v0.26.json`.

| Module       | Data Type / Operation                      | Mandated Algorithm      |
| :----------- | :----------------------------------------- | :---------------------- |
| Agreements   | Signing RDF-based agreements and contracts | **SPHINCS+** |
| Backups      | Signing encrypted backup archives          | **SPHINCS+** or **AES** |
| Community    | Signing contribution metadata              | **SPHINCS+** or **ECDSA** |
| Hypermedia   | Signing metadata for media files           | **EdDSA** |
| Blockchain   | Signing eCash transactions & SLP tokens    | **ECDSA** |
| Webizen API  | Securing `/security/sign-cid` endpoint     | **SPHINCS+** or **Ed25519** |

## 4. Advanced Considerations

-   **JWT (JSON Web Tokens):** Used for managing authentication and authorization, signed with Ed25519 for internal services and ECDSA for user-facing tokens.
-   **Zero-Knowledge Proofs (ZKPs):** Slated for future integration to enhance privacy for features like anonymous credential verification.
-   **COSE (CBOR Object Signing and Encryption):** To be adopted for creating compact, binary-encoded signed or encrypted messages, especially for constrained environments.
-   **WebAssembly (WASM):** Critical for performance, especially for SPHINCS+ and Falcon, allowing near-native execution speed.
-   **Nostr:** Webizen can act as a Nostr client, publishing Ed25519-signed events to the public relay network.

## 5. Transport Layer and Network Security

-   **TLS 1.3:** All standard client-server HTTP communications **MUST** use TLS 1.3.
-   **WireGuard (via Tailscale):** Used to establish the core peer-to-peer mesh network between a user's devices, creating a secure private network overlay.
-   **WebID-TLS:** Implemented for strong, password-less user authentication, using client certificates linked to a user's WebID during the TLS handshake.
-   **DNSSEC:** Recommended as a best practice for domains hosting WebID profiles to prevent DNS spoofing attacks.
