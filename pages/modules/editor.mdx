import { Mermaid } from 'nextra/components'

# Module: Editor

**The Editor module provides a powerful, full-featured code and text editing experience directly within the Webizen Desktop Application. It is designed to be a VSCode-like environment, integrating version control, real-time collaboration, and decentralized storage.**

This module empowers developers to write code, documentation, and notes without leaving the Webizen ecosystem.

## Purpose and Functionality

The primary goal of the `editor` module is to provide a first-class development and writing environment that is deeply integrated with Webizen's core principles of decentralization and collaboration.

**Core Functions:**
-   **Rich Text and Code Editing:** Built on the **Monaco Editor**, the same editor that powers Visual Studio Code, it provides features like syntax highlighting for dozens of languages, IntelliSense, and advanced editing commands.
-   **Real-time Collaborative Editing:** Multiple users can edit the same document simultaneously. Changes are synchronized in real-time between peers using the **GUN.eco** decentralized database.
-   **Git Integration:** The editor is integrated with the `gitmark` module, allowing developers to perform common git operations like staging, committing, and pushing changes directly from the editor interface.
-   **Decentralized Storage:** Files are saved to the user's **Solid Pod** via the `solidos` service, ensuring that the user always owns and controls their work.
-   **Browser Diagnostics:** Provides tools for inspecting and diagnosing web applications running within the Webizen environment.

## Technical Implementation

-   **Module Path**: `src/modules/editor/index.js`
-   **UI Component**: The main editor interface is rendered by `src/components/Editor.js`.
-   **Core Libraries**:
    -   `monaco-editor`: For the core text editor component.
    -   `gun`: For the real-time collaborative editing backend.
-   **Ontology**: `ontologies/editor-v1.ttl` defines the schema for editor-related metadata, such as multilingual comments or collaborative session information.
-   **Dependencies**:
    -   `modules/gitmark`: For all version control functionality.
    -   `modules/settings`: To load user preferences for the editor (e.g., themes, font sizes).
    -   `services/solidos`: To read and write files from the user's Solid Pod.
    -   `services/p2p` (which manages GUN): For establishing the real-time data synchronization channels.

### Example Flow: Collaborative Editing Session

This diagram illustrates how two users, Alice and Bob, can edit the same document in real time.

<Mermaid chart={`
sequenceDiagram
    participant Alice's Editor
    participant Alice's GUN Node
    participant Bob's GUN Node
    participant Bob's Editor

    Alice's Editor->>Alice's GUN Node: User types 'A' - Send update to GUN graph
    Alice's GUN Node-->>Bob's GUN Node: Propagate change over P2P network
    Bob's GUN Node-->>Bob's Editor: Receive update event
    Bob's Editor->>Bob's Editor: Apply 'A' to document

    Bob's Editor->>Bob's GUN Node: User types 'B' - Send update to GUN graph
    Bob's GUN Node-->>Alice's GUN Node: Propagate change over P2P network
    Alice's GUN Node-->>Alice's Editor: Receive update event
    Alice's Editor->>Alice's Editor: Apply 'B' to document
`} />

1.  **Initialization**: Alice opens a file from her Solid Pod. The `editor` module loads the content and subscribes to a specific graph node in GUN that represents the document. Bob does the same.
2.  **Alice Makes an Edit**: Alice types a character. The `Editor.js` component captures this change and sends the update (a "diff") to the local `editor` module.
3.  **GUN Propagation**: The `editor` module puts the change into the GUN database. GUN's P2P protocol automatically propagates this change to all subscribed peers, including Bob.
4.  **Bob Receives the Edit**: Bob's `editor` module receives the update from his GUN node and applies the change to his instance of the Monaco Editor, keeping the documents in sync.

This entire process happens in milliseconds and without a central server, providing a truly decentralized and collaborative editing experience.
